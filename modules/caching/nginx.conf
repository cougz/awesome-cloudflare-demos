# Cloudflare Caching Test Endpoints
# This configuration provides test endpoints for Cloudflare caching behavior

location /test-no-header/ {
    alias /usr/share/nginx/html/test-files/modules/caching/;
    # No Cache-Control header sent by origin
}

location /test-public/ {
    alias /usr/share/nginx/html/test-files/modules/caching/;
    add_header Cache-Control "public, max-age=600";
}

location /test-private/ {
    alias /usr/share/nginx/html/test-files/modules/caching/;
    add_header Cache-Control "private";
}

location /test-set-cookie/ {
    alias /usr/share/nginx/html/test-files/modules/caching/;
    add_header Set-Cookie "test=value; Path=/";
}

location /test-revalidate/ {
    alias /usr/share/nginx/html/test-files/modules/caching/;
    add_header Cache-Control "public, s-maxage=1";
}

location /test-no-store/ {
    alias /usr/share/nginx/html/test-files/modules/caching/;
    add_header Cache-Control "no-store";
}

location /test-s-maxage/ {
    alias /usr/share/nginx/html/test-files/modules/caching/;
    add_header Cache-Control "public, s-maxage=30";
}

location /test-cookie-auth/ {
    alias /usr/share/nginx/html/test-files/modules/caching/;
    # Check for auth_token cookie
    if ($cookie_auth_token != "my_secret_value") {
        return 403;
    }
    add_header Cache-Control "public";
}

location /test-dynamic-file {
    default_type text/plain;
    add_header Cache-Control "no-cache";
    return 200 "This is a dynamic file\n";
}

location /test-resize/ {
    alias /usr/share/nginx/html/test-files/modules/caching/;
    add_header Cache-Control "public";
}

# 404 test endpoint (file doesn't exist)
location /test-404.jpg {
    return 404;
}
